"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[745],{129:(e,t,s)=>{let r;s.d(t,{Z:()=>a});let i={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)},n=new Uint8Array(16),o=[];for(let e=0;e<256;++e)o.push((e+256).toString(16).slice(1));let a=function(e,t,s){if(i.randomUUID&&!t&&!e)return i.randomUUID();let a=(e=e||{}).random||(e.rng||function(){if(!r&&!(r="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)))throw Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return r(n)})();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t){s=s||0;for(let e=0;e<16;++e)t[s+e]=a[e];return t}return function(e,t=0){return o[e[t+0]]+o[e[t+1]]+o[e[t+2]]+o[e[t+3]]+"-"+o[e[t+4]]+o[e[t+5]]+"-"+o[e[t+6]]+o[e[t+7]]+"-"+o[e[t+8]]+o[e[t+9]]+"-"+o[e[t+10]]+o[e[t+11]]+o[e[t+12]]+o[e[t+13]]+o[e[t+14]]+o[e[t+15]]}(a)}},3611:(e,t,s)=>{s.d(t,{rs:()=>o});class r{controller;escapedUserTableName;escapedSessionTableName;constructor(e,t){this.controller=e,this.escapedSessionTableName=n(t.session),this.escapedUserTableName=n(t.user)}async deleteSession(e){await this.controller.execute(`DELETE FROM ${this.escapedSessionTableName} WHERE id = ?`,[e])}async deleteUserSessions(e){await this.controller.execute(`DELETE FROM ${this.escapedSessionTableName} WHERE user_id = ?`,[e])}async getSessionAndUser(e){let[t,s]=await Promise.all([this.getSession(e),this.getUserFromSessionId(e)]);return[t,s]}async getUserSessions(e){return(await this.controller.getAll(`SELECT * FROM ${this.escapedSessionTableName} WHERE user_id = ?`,[e])).map(e=>i(e))}async setSession(e){let t=Object.entries({id:e.id,user_id:e.userId,expires_at:Math.floor(e.expiresAt.getTime()/1e3),...e.attributes}).filter(([e,t])=>void 0!==t),s=t.map(([e])=>n(e)),r=Array(s.length).fill("?"),i=t.map(([e,t])=>t);await this.controller.execute(`INSERT INTO ${this.escapedSessionTableName} (${s.join(", ")}) VALUES (${r.join(", ")})`,i)}async updateSessionExpiration(e,t){await this.controller.execute(`UPDATE ${this.escapedSessionTableName} SET expires_at = ? WHERE id = ?`,[Math.floor(t.getTime()/1e3),e])}async deleteExpiredSessions(){await this.controller.execute(`DELETE FROM ${this.escapedSessionTableName} WHERE expires_at <= ?`,[Math.floor(Date.now()/1e3)])}async getSession(e){let t=await this.controller.get(`SELECT * FROM ${this.escapedSessionTableName} WHERE id = ?`,[e]);return t?i(t):null}async getUserFromSessionId(e){let t=await this.controller.get(`SELECT ${this.escapedUserTableName}.* FROM ${this.escapedSessionTableName} INNER JOIN ${this.escapedUserTableName} ON ${this.escapedUserTableName}.id = ${this.escapedSessionTableName}.user_id WHERE ${this.escapedSessionTableName}.id = ?`,[e]);return t?function(e){let{id:t,...s}=e;return{id:t,attributes:s}}(t):null}}function i(e){let{id:t,user_id:s,expires_at:r,...i}=e;return{userId:s,id:t,expiresAt:new Date(1e3*r),attributes:i}}function n(e){return"`"+e+"`"}class o extends r{constructor(e,t){super(new a(e),t)}}class a{db;constructor(e){this.db=e}async get(e,t){return await this.db.prepare(e).bind(...t).first()}async getAll(e,t){return(await this.db.prepare(e).bind(...t).all()).results??[]}async execute(e,t){await this.db.prepare(e).bind(...t).run()}}},6079:(e,t,s)=>{s.d(t,{jY:()=>n,mv:()=>o});class r{uint8(e,t){if(e.byteLength<t+1)throw TypeError("Insufficient bytes");return e[t]}uint16(e,t){if(e.byteLength<t+2)throw TypeError("Insufficient bytes");return e[t]<<8|e[t+1]}uint32(e,t){if(e.byteLength<t+4)throw TypeError("Insufficient bytes");let s=0;for(let r=0;r<4;r++)s|=e[t+r]<<24-8*r;return s}uint64(e,t){if(e.byteLength<t+8)throw TypeError("Insufficient bytes");let s=0n;for(let r=0;r<8;r++)s|=BigInt(e[t+r])<<BigInt(56-8*r);return s}putUint8(e,t,s){if(e.length<s+1)throw TypeError("Not enough space");if(t<0||t>255)throw TypeError("Invalid uint8 value");e[s]=t}putUint16(e,t,s){if(e.length<s+2)throw TypeError("Not enough space");if(t<0||t>65535)throw TypeError("Invalid uint16 value");e[s]=t>>8,e[s+1]=255&t}putUint32(e,t,s){if(e.length<s+4)throw TypeError("Not enough space");if(t<0||t>4294967295)throw TypeError("Invalid uint32 value");for(let r=0;r<4;r++)e[s+r]=t>>(3-r)*8&255}putUint64(e,t,s){if(e.length<s+8)throw TypeError("Not enough space");if(t<0||t>0xffffffffffffffffn)throw TypeError("Invalid uint64 value");for(let r=0;r<8;r++)e[s+r]=Number(t>>BigInt((7-r)*8)&255n)}}class i{uint8(e,t){if(e.byteLength<t+1)throw TypeError("Insufficient bytes");return e[t]}uint16(e,t){if(e.byteLength<t+2)throw TypeError("Insufficient bytes");return e[t]|e[t+1]<<8}uint32(e,t){if(e.byteLength<t+4)throw TypeError("Insufficient bytes");let s=0;for(let r=0;r<4;r++)s|=e[t+r]<<8*r;return s}uint64(e,t){if(e.byteLength<t+8)throw TypeError("Insufficient bytes");let s=0n;for(let r=0;r<8;r++)s|=BigInt(e[t+r])<<BigInt(8*r);return s}putUint8(e,t,s){if(e.length<1+s)throw TypeError("Insufficient space");if(t<0||t>255)throw TypeError("Invalid uint8 value");e[s]=t}putUint16(e,t,s){if(e.length<2+s)throw TypeError("Insufficient space");if(t<0||t>65535)throw TypeError("Invalid uint16 value");e[s+1]=t>>8,e[s]=255&t}putUint32(e,t,s){if(e.length<4+s)throw TypeError("Insufficient space");if(t<0||t>4294967295)throw TypeError("Invalid uint32 value");for(let r=0;r<4;r++)e[s+r]=t>>8*r&255}putUint64(e,t,s){if(e.length<8+s)throw TypeError("Insufficient space");if(t<0||t>0xffffffffffffffffn)throw TypeError("Invalid uint64 value");for(let r=0;r<8;r++)e[s+r]=Number(t>>BigInt(8*r)&255n)}}let n=new r;function o(e,t){return(e<<32-t|e>>>t)>>>0}new i},9160:(e,t,s)=>{var r,i,n,o;function a(e){return function(e,t,s){let i="";for(let n=0;n<e.byteLength;n+=5){let o=0n,a=0;for(let t=0;t<5&&n+t<e.byteLength;t++)o=o<<8n|BigInt(e[n+t]),a+=8;a%5!=0&&(o<<=BigInt(5-a%5),a+=5-a%5);for(let e=0;e<8;e++)a>=5?(i+=t[Number(o>>BigInt(a-5)&31n)],a-=5):a>0?(i+=t[Number(o<<BigInt(6-a)&63n)],a=0):s===r.Include&&(i+="=")}return i}(e,c,r.None)}s.d(t,{sS:()=>a,oF:()=>l,Hs:()=>h});let c="abcdefghijklmnopqrstuvwxyz234567";function l(e){return u(e,d,n.Include)}function h(e){return u(e,f,n.None)}function u(e,t,s){let r="";for(let i=0;i<e.byteLength;i+=3){let o=0,a=0;for(let t=0;t<3&&i+t<e.byteLength;t++)o=o<<8|e[i+t],a+=8;for(let e=0;e<4;e++)a>=6?(r+=t[o>>a-6&63],a-=6):a>0?(r+=t[o<<6-a&63],a=0):s===n.Include&&(r+="=")}return r}!function(e){e[e.Include=0]="Include",e[e.None=1]="None"}(r||(r={})),function(e){e[e.Required=0]="Required",e[e.Ignore=1]="Ignore"}(i||(i={}));let d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_";!function(e){e[e.Include=0]="Include",e[e.None=1]="None"}(n||(n={})),function(e){e[e.Required=0]="Required",e[e.Ignore=1]="Ignore"}(o||(o={}))},9560:(e,t,s)=>{s.d(t,{ie:()=>A,yD:()=>_,Uj:()=>p,aV:()=>b});var r,i,n,o,a,c=s(9160),l=s(6079);new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);class h{blockSize=64;size=32;blocks=new Uint8Array(64);currentBlockSize=0;H=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]);l=0n;w=new Uint32Array(64);update(e){if(this.l+=8n*BigInt(e.byteLength),this.currentBlockSize+e.byteLength<64){this.blocks.set(e,this.currentBlockSize),this.currentBlockSize+=e.byteLength;return}let t=0;if(this.currentBlockSize>0){let s=e.slice(0,64-this.currentBlockSize);this.blocks.set(s,this.currentBlockSize),this.process(),t+=s.byteLength,this.currentBlockSize=0}for(;t+64<=e.byteLength;){let s=e.slice(t,t+64);this.blocks.set(s),this.process(),t+=64}if(e.byteLength-t>0){let s=e.slice(t);this.blocks.set(s),this.currentBlockSize=s.byteLength}}digest(){this.blocks[this.currentBlockSize]=128,this.currentBlockSize+=1,64-this.currentBlockSize<8&&(this.blocks.fill(0,this.currentBlockSize),this.process(),this.currentBlockSize=0),this.blocks.fill(0,this.currentBlockSize),l.jY.putUint64(this.blocks,this.l,this.blockSize-8),this.process();let e=new Uint8Array(32);for(let t=0;t<8;t++)l.jY.putUint32(e,this.H[t],4*t);return e}process(){for(let e=0;e<16;e++)this.w[e]=(this.blocks[4*e]<<24|this.blocks[4*e+1]<<16|this.blocks[4*e+2]<<8|this.blocks[4*e+3])>>>0;for(let e=16;e<64;e++){let t=((0,l.mv)(this.w[e-2],17)^(0,l.mv)(this.w[e-2],19)^this.w[e-2]>>>10)>>>0,s=((0,l.mv)(this.w[e-15],7)^(0,l.mv)(this.w[e-15],18)^this.w[e-15]>>>3)>>>0;this.w[e]=t+this.w[e-7]+s+this.w[e-16]|0}let e=this.H[0],t=this.H[1],s=this.H[2],r=this.H[3],i=this.H[4],n=this.H[5],o=this.H[6],a=this.H[7];for(let c=0;c<64;c++){let h=a+(((0,l.mv)(i,6)^(0,l.mv)(i,11)^(0,l.mv)(i,25))>>>0)+((i&n^~i&o)>>>0)+u[c]+this.w[c]|0,d=(((0,l.mv)(e,2)^(0,l.mv)(e,13)^(0,l.mv)(e,22))>>>0)+((e&t^e&s^t&s)>>>0)|0;a=o,o=n,n=i,i=r+h|0,r=s,s=t,t=e,e=h+d|0}this.H[0]=e+this.H[0]|0,this.H[1]=t+this.H[1]|0,this.H[2]=s+this.H[2]|0,this.H[3]=r+this.H[3]|0,this.H[4]=i+this.H[4]|0,this.H[5]=n+this.H[5]|0,this.H[6]=o+this.H[6]|0,this.H[7]=a+this.H[7]|0}}let u=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),d=new BigUint64Array([0x428a2f98d728ae22n,0x7137449123ef65cdn,0xb5c0fbcfec4d3b2fn,0xe9b5dba58189dbbcn,0x3956c25bf348b538n,0x59f111f1b605d019n,0x923f82a4af194f9bn,0xab1c5ed5da6d8118n,0xd807aa98a3030242n,0x12835b0145706fben,0x243185be4ee4b28cn,0x550c7dc3d5ffb4e2n,0x72be5d74f27b896fn,0x80deb1fe3b1696b1n,0x9bdc06a725c71235n,0xc19bf174cf692694n,0xe49b69c19ef14ad2n,0xefbe4786384f25e3n,0xfc19dc68b8cd5b5n,0x240ca1cc77ac9c65n,0x2de92c6f592b0275n,0x4a7484aa6ea6e483n,0x5cb0a9dcbd41fbd4n,0x76f988da831153b5n,0x983e5152ee66dfabn,0xa831c66d2db43210n,0xb00327c898fb213fn,0xbf597fc7beef0ee4n,0xc6e00bf33da88fc2n,0xd5a79147930aa725n,0x6ca6351e003826fn,0x142929670a0e6e70n,0x27b70a8546d22ffcn,0x2e1b21385c26c926n,0x4d2c6dfc5ac42aedn,0x53380d139d95b3dfn,0x650a73548baf63den,0x766a0abb3c77b2a8n,0x81c2c92e47edaee6n,0x92722c851482353bn,0xa2bfe8a14cf10364n,0xa81a664bbc423001n,0xc24b8b70d0f89791n,0xc76c51a30654be30n,0xd192e819d6ef5218n,0xd69906245565a910n,0xf40e35855771202an,0x106aa07032bbd1b8n,0x19a4c116b8d2d0c8n,0x1e376c085141ab53n,0x2748774cdf8eeb99n,0x34b0bcb5e19b48a8n,0x391c0cb3c5c95a63n,0x4ed8aa4ae3418acbn,0x5b9cca4f7763e373n,0x682e6ff3d6b2b8a3n,0x748f82ee5defb2fcn,0x78a5636f43172f60n,0x84c87814a1f0ab72n,0x8cc702081a6439ecn,0x90befffa23631e28n,0xa4506cebde82bde9n,0xbef9a3f7b2c67915n,0xc67178f2e372532bn,0xca273eceea26619cn,0xd186b8c721c0c207n,0xeada7dd6cde0eb1en,0xf57d4f7fee6ed178n,0x6f067aa72176fban,0xa637dc5a2c898a6n,0x113f9804bef90daen,0x1b710b35131c471bn,0x28db77f523047d84n,0x32caab7b40c72493n,0x3c9ebe0a15c9bebcn,0x431d67c49c100d4cn,0x4cc5d4becb3e42b6n,0x597f299cfc657e2an,0x5fcb6fab3ad6faecn,0x6c44198c4a475817n]);class f{data;constructor(e){this.data=e}tokenType(){if("token_type"in this.data&&"string"==typeof this.data.token_type)return this.data.token_type;throw Error("Missing or invalid 'token_type' field")}accessToken(){if("access_token"in this.data&&"string"==typeof this.data.access_token)return this.data.access_token;throw Error("Missing or invalid 'access_token' field")}accessTokenExpiresInSeconds(){if("expires_in"in this.data&&"number"==typeof this.data.expires_in)return this.data.expires_in;throw Error("Missing or invalid 'expires_in' field")}accessTokenExpiresAt(){return new Date(Date.now()+1e3*this.accessTokenExpiresInSeconds())}hasRefreshToken(){return"refresh_token"in this.data&&"string"==typeof this.data.refresh_token}refreshToken(){if("refresh_token"in this.data&&"string"==typeof this.data.refresh_token)return this.data.refresh_token;throw Error("Missing or invalid 'refresh_token' field")}hasScopes(){return"scope"in this.data&&"string"==typeof this.data.scope}scopes(){if("scope"in this.data&&"string"==typeof this.data.scope)return this.data.scope.split(" ");throw Error("Missing or invalid 'scope' field")}idToken(){if("id_token"in this.data&&"string"==typeof this.data.id_token)return this.data.id_token;throw Error("Missing or invalid field 'id_token'")}}function p(){let e=new Uint8Array(32);return crypto.getRandomValues(e),c.Hs(e)}function b(){let e=new Uint8Array(32);return crypto.getRandomValues(e),c.Hs(e)}function w(e,t){let s=new TextEncoder().encode(t.toString()),r=new Request(e,{method:"POST",body:s});return r.headers.set("Content-Type","application/x-www-form-urlencoded"),r.headers.set("Accept","application/json"),r.headers.set("User-Agent","arctic"),r.headers.set("Content-Length",s.byteLength.toString()),r}function y(e,t){let s=new TextEncoder().encode(`${e}:${t}`);return c.oF(s)}async function x(e){let t;try{t=await fetch(e)}catch(e){throw new I(e)}if(400===t.status||401===t.status){let e,s;try{e=await t.json()}catch{throw new E(t.status)}if("object"!=typeof e||null===e)throw new S(t.status,e);try{s=m(e)}catch{throw new S(t.status,e)}throw s}if(200===t.status){let e;try{e=await t.json()}catch{throw new E(t.status)}if("object"!=typeof e||null===e)throw new S(t.status,e);return new f(e)}throw null!==t.body&&await t.body.cancel(),new E(t.status)}async function g(e){let t;try{t=await fetch(e)}catch(e){throw new I(e)}if(400===t.status||401===t.status){let e,s;try{e=await t.json()}catch{throw new S(t.status,null)}if("object"!=typeof e||null===e)throw new S(t.status,e);try{s=m(e)}catch{throw new S(t.status,e)}throw s}if(200===t.status){null!==t.body&&await t.body.cancel();return}throw null!==t.body&&await t.body.cancel(),new E(t.status)}function m(e){let t;if("error"in e&&"string"==typeof e.error)t=e.error;else throw Error("Invalid error response");let s=null,r=null,i=null;if("error_description"in e){if("string"!=typeof e.error_description)throw Error("Invalid data");s=e.error_description}if("error_uri"in e){if("string"!=typeof e.error_uri)throw Error("Invalid data");r=e.error_uri}if("state"in e){if("string"!=typeof e.state)throw Error("Invalid data");i=e.state}return new k(t,s,r,i)}class I extends Error{constructor(e){super("Failed to send request",{cause:e})}}class k extends Error{code;description;uri;state;constructor(e,t,s,r){super(`OAuth request error: ${e}`),this.code=e,this.description=t,this.uri=s,this.state=r}}class E extends Error{status;constructor(e){super("Unexpected error response"),this.status=e}}class S extends Error{status;data;constructor(e,t){super("Unexpected error response body"),this.status=e,this.data=t}}class v{clientId;clientPassword;redirectURI;constructor(e,t,s){this.clientId=e,this.clientPassword=t,this.redirectURI=s}createAuthorizationURL(e,t,s){let r=new URL(e);return r.searchParams.set("response_type","code"),r.searchParams.set("client_id",this.clientId),null!==this.redirectURI&&r.searchParams.set("redirect_uri",this.redirectURI),r.searchParams.set("state",t),s.length>0&&r.searchParams.set("scope",s.join(" ")),r}createAuthorizationURLWithPKCE(e,t,s,i,n){let o=new URL(e);if(o.searchParams.set("response_type","code"),o.searchParams.set("client_id",this.clientId),null!==this.redirectURI&&o.searchParams.set("redirect_uri",this.redirectURI),o.searchParams.set("state",t),s===r.S256){let e=function(e){let t=function(e){let t=new h;return t.update(e),t.digest()}(new TextEncoder().encode(e));return c.Hs(t)}(i);o.searchParams.set("code_challenge_method","S256"),o.searchParams.set("code_challenge",e)}else s===r.Plain&&(o.searchParams.set("code_challenge_method","plain"),o.searchParams.set("code_challenge",i));return n.length>0&&o.searchParams.set("scope",n.join(" ")),o}async validateAuthorizationCode(e,t,s){let r=new URLSearchParams;r.set("grant_type","authorization_code"),r.set("code",t),null!==this.redirectURI&&r.set("redirect_uri",this.redirectURI),null!==s&&r.set("code_verifier",s),null===this.clientPassword&&r.set("client_id",this.clientId);let i=w(e,r);if(null!==this.clientPassword){let e=y(this.clientId,this.clientPassword);i.headers.set("Authorization",`Basic ${e}`)}return await x(i)}async refreshAccessToken(e,t,s){let r=new URLSearchParams;r.set("grant_type","refresh_token"),r.set("refresh_token",t),null===this.clientPassword&&r.set("client_id",this.clientId),s.length>0&&r.set("scope",s.join(" "));let i=w(e,r);if(null!==this.clientPassword){let e=y(this.clientId,this.clientPassword);i.headers.set("Authorization",`Basic ${e}`)}return await x(i)}async revokeToken(e,t){let s=new URLSearchParams;s.set("token",t),null===this.clientPassword&&s.set("client_id",this.clientId);let r=w(e,s);if(null!==this.clientPassword){let e=y(this.clientId,this.clientPassword);r.headers.set("Authorization",`Basic ${e}`)}await g(r)}}!function(e){e[e.S256=0]="S256",e[e.Plain=1]="Plain"}(r||(r={})),!function(e){e[e.Include=0]="Include",e[e.None=1]="None"}(i||(i={})),function(e){e[e.Required=0]="Required",e[e.Ignore=1]="Ignore"}(n||(n={})),!function(e){e[e.Include=0]="Include",e[e.None=1]="None"}(o||(o={})),function(e){e[e.Required=0]="Required",e[e.Ignore=1]="Ignore"}(a||(a={}));let T={0:52,1:53,2:54,3:55,4:56,5:57,6:58,7:59,8:60,9:61,A:0,B:1,C:2,D:3,E:4,F:5,G:6,H:7,I:8,J:9,K:10,L:11,M:12,N:13,O:14,P:15,Q:16,R:17,S:18,T:19,U:20,V:21,W:22,X:23,Y:24,Z:25,a:26,b:27,c:28,d:29,e:30,f:31,g:32,h:33,i:34,j:35,k:36,l:37,m:38,n:39,o:40,p:41,q:42,r:43,s:44,t:45,u:46,v:47,w:48,x:49,y:50,z:51,"-":62,_:63},U="https://oauth2.googleapis.com/token";class A{client;constructor(e,t,s){this.client=new v(e,t,s)}createAuthorizationURL(e,t,s){return this.client.createAuthorizationURLWithPKCE("https://accounts.google.com/o/oauth2/v2/auth",e,r.S256,t,s)}async validateAuthorizationCode(e,t){return await this.client.validateAuthorizationCode(U,e,t)}async refreshAccessToken(e){return await this.client.refreshAccessToken(U,e,[])}async revokeToken(e){await this.client.revokeToken("https://oauth2.googleapis.com/revoke",e)}}function _(e){try{return function(e){let t,s;let r=e.split(".");if(3!==r.length)throw Error("Invalid JWT");try{var i;t=new TextDecoder().decode((i=r[1],function(e,t,s){let r=new Uint8Array(3*Math.ceil(e.length/4)),i=0;for(let n=0;n<e.length;n+=4){let o=0,c=0;for(let r=0;r<4;r++)if((s!==a.Required||"="!==e[n+r])&&(s!==a.Ignore||!(n+r>=e.length)&&"="!==e[n+r])){if(r>0&&"="===e[n+r-1])throw Error("Invalid padding");if(!(e[n+r]in t))throw Error("Invalid character");o|=t[e[n+r]]<<(3-r)*6,c+=6}if(c<24){let e;if(12===c)e=65535&o;else if(18===c)e=255&o;else throw Error("Invalid padding");if(0!==e)throw Error("Invalid padding")}let l=Math.floor(c/8);for(let e=0;e<l;e++)r[i]=o>>16-8*e&255,i++}return r.slice(0,i)}(i,T,a.Ignore)))}catch{throw Error("Invalid JWT: Invalid base64url encoding")}try{s=JSON.parse(t)}catch{throw Error("Invalid JWT: Invalid JSON encoding")}if("object"!=typeof s||null===s)throw Error("Invalid JWT: Invalid payload");return s}(e)}catch(e){throw Error("Invalid ID token",{cause:e})}}},2813:(e,t,s)=>{s.d(t,{aF:()=>l,i9:()=>r});class r{constructor(e,t){this.value=e,this.unit=t}value;unit;milliseconds(){return"ms"===this.unit?this.value:"s"===this.unit?1e3*this.value:"m"===this.unit?6e4*this.value:"h"===this.unit?36e5*this.value:"d"===this.unit?864e5*this.value:6048e5*this.value}seconds(){return this.milliseconds()/1e3}transform(e){return new r(Math.round(this.milliseconds()*e),"ms")}}function i(e){return Date.now()<e.getTime()}function n(e){return new Date(Date.now()+e.milliseconds())}class o{constructor(e,t,s){this.cookieName=e,this.cookieExpiresIn=s?.expiresIn??null,this.baseCookieAttributes=t}cookieName;cookieExpiresIn;baseCookieAttributes;createCookie(e){return new a(this.cookieName,e,{...this.baseCookieAttributes,maxAge:this.cookieExpiresIn?.seconds()})}createBlankCookie(){return new a(this.cookieName,"",{...this.baseCookieAttributes,maxAge:0})}parse(e){return(function(e){let t=new Map;for(let s of e.split("; ")){let e=s.split("="),r=e[0],i=e[1]??"";r&&t.set(decodeURIComponent(r),decodeURIComponent(i))}return t})(e).get(this.cookieName)??null}}class a{constructor(e,t,s){this.name=e,this.value=t,this.attributes=s}name;value;attributes;serialize(){return function(e,t,s){let r=[];return r.push([encodeURIComponent(e),encodeURIComponent(t)]),s?.domain!==void 0&&r.push(["Domain",s.domain]),s?.expires!==void 0&&r.push(["Expires",s.expires.toUTCString()]),s?.httpOnly&&r.push(["HttpOnly"]),s?.maxAge!==void 0&&r.push(["Max-Age",s.maxAge.toString()]),s?.path!==void 0&&r.push(["Path",s.path]),s?.sameSite==="lax"&&r.push(["SameSite","Lax"]),s?.sameSite==="none"&&r.push(["SameSite","None"]),s?.sameSite==="strict"&&r.push(["SameSite","Strict"]),s?.secure&&r.push(["Secure"]),r.map(e=>e.join("=")).join("; ")}(this.name,this.value,this.attributes)}}var c=s(9160);s(6079);class l{adapter;sessionExpiresIn;sessionCookieController;getSessionAttributes;getUserAttributes;sessionCookieName;constructor(e,t){this.adapter=e,this.getUserAttributes=e=>t&&t.getUserAttributes?t.getUserAttributes(e):{},this.getSessionAttributes=e=>t&&t.getSessionAttributes?t.getSessionAttributes(e):{},this.sessionExpiresIn=t?.sessionExpiresIn??new r(30,"d"),this.sessionCookieName=t?.sessionCookie?.name??"auth_session";let s=this.sessionExpiresIn;t?.sessionCookie?.expires===!1&&(s=new r(400,"d"));let i={httpOnly:!0,secure:!0,sameSite:"lax",path:"/",...t?.sessionCookie?.attributes};this.sessionCookieController=new o(this.sessionCookieName,i,{expiresIn:s})}async getUserSessions(e){let t=await this.adapter.getUserSessions(e),s=[];for(let e of t)i(e.expiresAt)&&s.push({id:e.id,expiresAt:e.expiresAt,userId:e.userId,fresh:!1,...this.getSessionAttributes(e.attributes)});return s}async validateSession(e){let[t,s]=await this.adapter.getSessionAndUser(e);if(!t)return{session:null,user:null};if(!s||!i(t.expiresAt))return await this.adapter.deleteSession(t.id),{session:null,user:null};let r=new Date(t.expiresAt.getTime()-this.sessionExpiresIn.milliseconds()/2),o={...this.getSessionAttributes(t.attributes),id:t.id,userId:t.userId,fresh:!1,expiresAt:t.expiresAt};return i(r)||(o.fresh=!0,o.expiresAt=n(this.sessionExpiresIn),await this.adapter.updateSessionExpiration(t.id,o.expiresAt)),{user:{...this.getUserAttributes(s.attributes),id:s.id},session:o}}async createSession(e,t,s){let r=s?.sessionId??function(e){let t=crypto.getRandomValues(new Uint8Array(25));return(0,c.sS)(t)}(0),i=n(this.sessionExpiresIn);return await this.adapter.setSession({id:r,userId:e,expiresAt:i,attributes:t}),{id:r,userId:e,fresh:!0,expiresAt:i,...this.getSessionAttributes(t)}}async invalidateSession(e){await this.adapter.deleteSession(e)}async invalidateUserSessions(e){await this.adapter.deleteUserSessions(e)}async deleteExpiredSessions(){await this.adapter.deleteExpiredSessions()}readSessionCookie(e){return this.sessionCookieController.parse(e)}readBearerToken(e){let[t,s]=e.split(" ");return"Bearer"!==t?null:s??null}createSessionCookie(e){return this.sessionCookieController.createCookie(e)}createBlankSessionCookie(){return this.sessionCookieController.createBlankCookie()}}}}]);
//# sourceMappingURL=745.js.map