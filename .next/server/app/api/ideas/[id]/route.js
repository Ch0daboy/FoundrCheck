(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[873],{2067:e=>{"use strict";e.exports=require("node:async_hooks")},6195:e=>{"use strict";e.exports=require("node:buffer")},5918:(e,t,r)=>{"use strict";r.r(t),r.d(t,{ComponentMod:()=>y,default:()=>R});var s={};r.r(s),r.d(s,{GET:()=>c,runtime:()=>p});var i={};r.r(i),r.d(i,{originalPathname:()=>E,patchFetch:()=>m,requestAsyncStorage:()=>f,routeModule:()=>_,serverHooks:()=>w,staticGenerationAsyncStorage:()=>h});var a=r(9010),n=r(8126),u=r(3097),o=r(4307),d=r(830),l=r(2491);let p="edge";async function c(e,t){let r=(0,l.O)(),s=t.params.id,i=await (0,d.bN)(r,e),a=await r.DB.prepare("SELECT * FROM ideas WHERE id = ?").bind(s).all();return a.results?.length?new Response(JSON.stringify(function(e,t){let r=t&&e.owner_id===t;return{id:e.id,owner_id:r?e.owner_id:void 0,title:e.title,description:e.description,idea_hash:r?e.idea_hash:void 0,visibility:e.visibility,status:e.status,score:e.score,analysis_summary:e.analysis_summary,analysis_raw:r?e.analysis_raw:void 0,created_at:e.created_at,updated_at:e.updated_at,owner_anon:!r}}(a.results[0],i)),{status:200}):new Response("Not found",{status:404})}let _=new n.AppRouteRouteModule({definition:{kind:u.x.APP_ROUTE,page:"/api/ideas/[id]/route",pathname:"/api/ideas/[id]",filename:"route",bundlePath:"app/api/ideas/[id]/route"},resolvedPagePath:"/home/noob/FoundrCheck/app/api/ideas/[id]/route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:f,staticGenerationAsyncStorage:h,serverHooks:w}=_,E="/api/ideas/[id]/route";function m(){return(0,o.XH)({serverHooks:w,staticGenerationAsyncStorage:h})}let y=i,R=a.a.wrap(_)},830:(e,t,r)=>{"use strict";r.d(t,{M9:()=>o,bN:()=>l,r4:()=>u,v0:()=>n});var s=r(3804),i=r(6645),a=r(7900);function n(e){let t=new i.rs(e.DB,{user:"users",session:"sessions",key:"user_keys"});return new s.aF(t,{sessionCookie:{name:d,attributes:{secure:!0,httpOnly:!0,sameSite:"lax",path:"/"}},getUserAttributes:e=>({email:e.email})})}async function u(e,t,r){let s=(0,a.Z)(),i=n(e);return await i.createUser({userId:s,key:{providerId:"email",providerUserId:t,password:r},attributes:{email:t}}),await e.DB.prepare("INSERT OR IGNORE INTO user_profiles (id, email) VALUES (?, ?)").bind(s,t).run(),s}async function o(e,t,r){let s=`email:${t}`,i=await e.DB.prepare("SELECT user_id, hashed_password FROM user_keys WHERE id = ?").bind(s).all(),a=i.results?.[0];return a&&a.hashed_password===r?a.user_id:null}let d="fc_session";async function l(e,t){let r=function(e,t){let r=e.headers.get("cookie");if(!r)return null;for(let e of r.split(";")){let[r,s]=e.trim().split("=");if(r===t)return decodeURIComponent(s??"")}return null}(t,d);if(!r)return null;let s=await e.DB.prepare("SELECT user_id, expires_at FROM sessions WHERE id = ?").bind(r).all(),i=s.results?.[0];if(!i)return null;let a=Math.floor(Date.now()/1e3),n=Number(i.expires_at);return Number.isFinite(n)&&n<a?null:i.user_id}},2491:(e,t,r)=>{"use strict";r.d(t,{O:()=>i});var s=r(9650);function i(){return(0,s.getRequestContext)().env}}},e=>{var t=t=>e(e.s=t);e.O(0,[992,111,109],()=>t(5918));var r=e.O();(_ENTRIES="undefined"==typeof _ENTRIES?{}:_ENTRIES)["middleware_app/api/ideas/[id]/route"]=r}]);
//# sourceMappingURL=route.js.map