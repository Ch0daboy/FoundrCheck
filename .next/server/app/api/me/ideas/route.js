(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[729],{2067:e=>{"use strict";e.exports=require("node:async_hooks")},6195:e=>{"use strict";e.exports=require("node:buffer")},2700:(e,t,r)=>{"use strict";r.r(t),r.d(t,{ComponentMod:()=>w,default:()=>b});var s={};r.r(s),r.d(s,{GET:()=>c,runtime:()=>p});var a={};r.r(a),r.d(a,{originalPathname:()=>h,patchFetch:()=>R,requestAsyncStorage:()=>E,routeModule:()=>f,serverHooks:()=>_,staticGenerationAsyncStorage:()=>m});var i=r(9010),n=r(8126),u=r(3097),o=r(4307),l=r(830),d=r(2491);let p="edge";async function c(e){let t=(0,d.O)(),r=await (0,l.bN)(t,e);return r?new Response(JSON.stringify((await t.DB.prepare("SELECT * FROM ideas WHERE owner_id = ? ORDER BY created_at DESC").bind(r).all()).results??[]),{status:200}):new Response("Unauthorized",{status:401})}let f=new n.AppRouteRouteModule({definition:{kind:u.x.APP_ROUTE,page:"/api/me/ideas/route",pathname:"/api/me/ideas",filename:"route",bundlePath:"app/api/me/ideas/route"},resolvedPagePath:"/home/noob/FoundrCheck/app/api/me/ideas/route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:E,staticGenerationAsyncStorage:m,serverHooks:_}=f,h="/api/me/ideas/route";function R(){return(0,o.XH)({serverHooks:_,staticGenerationAsyncStorage:m})}let w=a,b=i.a.wrap(f)},830:(e,t,r)=>{"use strict";r.d(t,{M9:()=>o,bN:()=>d,r4:()=>u,v0:()=>n});var s=r(3804),a=r(6645),i=r(7900);function n(e){let t=new a.rs(e.DB,{user:"users",session:"sessions",key:"user_keys"});return new s.aF(t,{sessionCookie:{name:l,attributes:{secure:!0,httpOnly:!0,sameSite:"lax",path:"/"}},getUserAttributes:e=>({email:e.email})})}async function u(e,t,r){let s=(0,i.Z)(),a=n(e);return await a.createUser({userId:s,key:{providerId:"email",providerUserId:t,password:r},attributes:{email:t}}),await e.DB.prepare("INSERT OR IGNORE INTO user_profiles (id, email) VALUES (?, ?)").bind(s,t).run(),s}async function o(e,t,r){let s=`email:${t}`,a=await e.DB.prepare("SELECT user_id, hashed_password FROM user_keys WHERE id = ?").bind(s).all(),i=a.results?.[0];return i&&i.hashed_password===r?i.user_id:null}let l="fc_session";async function d(e,t){let r=function(e,t){let r=e.headers.get("cookie");if(!r)return null;for(let e of r.split(";")){let[r,s]=e.trim().split("=");if(r===t)return decodeURIComponent(s??"")}return null}(t,l);if(!r)return null;let s=await e.DB.prepare("SELECT user_id, expires_at FROM sessions WHERE id = ?").bind(r).all(),a=s.results?.[0];if(!a)return null;let i=Math.floor(Date.now()/1e3),n=Number(a.expires_at);return Number.isFinite(n)&&n<i?null:a.user_id}},2491:(e,t,r)=>{"use strict";r.d(t,{O:()=>a});var s=r(9650);function a(){return(0,s.getRequestContext)().env}}},e=>{var t=t=>e(e.s=t);e.O(0,[992,111,109],()=>t(2700));var r=e.O();(_ENTRIES="undefined"==typeof _ENTRIES?{}:_ENTRIES)["middleware_app/api/me/ideas/route"]=r}]);
//# sourceMappingURL=route.js.map